# f5 chunk search

## f5s1 initial build
### if
* module outputs text for files
### when
* service starts
### then
* `content.json` and [*chunk*](glossary.md#chunk) docs created
* concept query returns chunk

## f5s2 add file
### if
* service running
### when
* new file added
### then
* new `content.json` and [*chunk*](glossary.md#chunk) docs created
* query returns chunk

## f5s3 modify file
### if
* existing file bytes change
### when
* next sync
### then
* new [*chunk*](glossary.md#chunk) docs created
* old docs kept

## f5s4 schema complete
### if
* any `chunks.json`
### when
* file opened
### then
* each [*chunk*](glossary.md#chunk) has required fields

## f5s5 sort and page
### if
* [*search host*](glossary.md#search-host) healthy
### when
* query with sort and pagination
### then
* results ordered and sliced accordingly

## f5s6 size or overlap change
### if
* `TOKENS_PER_CHUNK` or `CHUNK_OVERLAP` changed
### when
* stack restarts
### then
* all [*chunk*](glossary.md#chunk) docs rebuilt

## f5s7 embed model change
### if
* `EMBED_MODEL_NAME` changed
### when
* stack restarts
### then
* [*chunk*](glossary.md#chunk) vectors recomputed
* `content.json` unchanged

## f5s8 warm restart
### if
* stack restarts with same settings
### when
* service starts
### then
* no [*chunk*](glossary.md#chunk) timestamps change

## f5s9 deletion
### if
* file removed
### when
* restart or rescan
### then
* related [*chunk*](glossary.md#chunk) docs removed from search and disk

## f5s10 hybrid filter
### if
* module field `module` set
### when
* hybrid query with [*filter*](glossary.md#filter)
### then
* results only from matching module
