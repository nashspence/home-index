version: '3.9'
services:
  home-index:
    image: repo-runtime:latest
    environment:
      - CRON_EXPRESSION=${CRON_EXPRESSION}
      - MODULES=
      - MEILISEARCH_HOST=http://meilisearch:7700
      - LOGGING_DIRECTORY=/home-index
      - METADATA_DIRECTORY=/home-index/metadata
      - BY_ID_DIRECTORY=/home-index/metadata/by-id
      - BY_PATH_DIRECTORY=/home-index/metadata/by-path
      - ARCHIVE_DIRECTORY=/home-index/archive
    volumes:
      - ./input:/files:ro
      - ./output:/home-index
    depends_on:
      - meilisearch
  meilisearch:
    image: getmeili/meilisearch:v1.15.2
    environment:
      - MEILI_NO_ANALYTICS=true
    volumes:
      - ./output/meili:/meili_data

