# F2. "I want metadata stored by file ID"

## Value

Grouping metadata by a stable identifier keeps files deduplicated and makes lookup predictable.

---

## Usage

When the container indexes your files, each document is written under `metadata/by-id/<file-id>/document.json`.

---

## Minimal `docker-compose.yml`

```yaml
services:
  home-index:
    image: ghcr.io/nashspence/home-index:latest
    environment:
      - CRON_EXPRESSION=* * * * * *
      - METADATA_DIRECTORY=/home-index/metadata
    volumes:
      - ./input:/files:ro
      - ./output:/home-index
    depends_on:
      - meilisearch
  meilisearch:
    image: getmeili/meilisearch:latest
    volumes:
      - ./output/meili:/meili_data
```

---

## User Testing

```bash
mkdir -p input output
echo "hello world" > input/hello.txt
# Launch the stack
IMAGE=ghcr.io/nashspence/home-index:latest docker compose up -d
```

After the first sync completes, inspect `output/metadata/by-id/` for a directory named by the file's hash containing `document.json`.

---

## Input â†” Output

| **Your single action** | **What you will literally see** |
| --- | --- |
| Run `docker compose up -d` with at least one file in `./input/` | A folder named after the file's xxhash appears under `./output/metadata/by-id/` containing `document.json`. |

---

## Acceptance

1. With at least one file in `./input/`, the first sync creates a directory under `./output/metadata/by-id/`.
2. `document.json` inside that directory contains an `id` field equal to the directory name.
